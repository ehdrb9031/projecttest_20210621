<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hk.cal">
	<insert id="insertCal" parameterType="Map">
		INSERT ALL
		<foreach collection="works" item="wdate">
		INTO TOTALCAL (TO_SEQ ,ID, WDATE)
		VALUES (get_seq,
			<foreach collection="ids" item="id">
				#{id}		
			</foreach> 
		,#{wdate})
		</foreach>
		SELECT * FROM DUAL
	</insert>
	
	<select id="getCal" parameterType="String" resultType="String">
		SELECT WDATE FROM TOTALCAL WHERE ID =#{id}
	</select>
	
	<select id="getGivenId" parameterType="String" resultType="String">
		SELECT DISTINCT ID FROM TOTALCAL WHERE SUBSTR(WDATE,0,6)=#{yyyymm}
	</select>
	
	<select id="getAllList" resultType="CalDto">
		SELECT ID , WDATE FROM TOTALCAL
	</select>
	
	<select id="getownlist" parameterType="String" resultType="String">
		SELECT WDATE FROM TOTALCAL WHERE ID=#{id}
	</select>
	
	<update id="updateWork" parameterType="String"> 
		UPDATE TOTALCAL SET WDATE=#{wdate} FROM TOTALCAL WHERE ID=#{id}
	</update> 
<!-- 	서브 스트링으로 짜르고,  년월일을 조건으로 해서 다중업데이트? -->

	<update id="updateWdate" parameterType="Map">
		UPDATE TOTALCAL SET WDATE=#{odate} WHERE SUBSTR(WDATE,0,8)=#{wdate} AND ID =#{id}; 
	</update>
</mapper>